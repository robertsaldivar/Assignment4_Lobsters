---
title: "Assignment4_Lobsters"
author: "Robert Saldivar"
date: "November 13, 2018"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=FALSE}
#1. Loading Packages and csv files

library(tidyverse)
library(RColorBrewer)
library(ggpubr)
library(knitr)
library(effsize)
library(pwr)
library(extrafont)
library(plotly)
library(ggrepel)
library(kableExtra)
library(onewaytests)
library(car)
library(vcdExtra) #for getting the data into case format

lobster_size <- read_csv("lobster_size_abundance.csv")
lobster_traps <- read_csv("lobster_traps.csv")
```

```{r}
#2 Initial Data Editing
lobster_size_edits <- lobster_size %>%
  filter(SIZE !=-99999) %>%
  select(YEAR, SITE, SIZE, COUNT) # Edit Lobster Size data to remove -99999 data from size column and remove transect information
  

lobster_traps_edits <- lobster_traps %>%
  filter(SITE=="AQUE" |SITE =="NAPL" |SITE=="MOHK" |SITE=="IVEE" |SITE=="CARP") %>%
  select(YEAR, SITE, TRAPS)

```

```{r}
#3 checking data for normality

lobster_size_hist <- ggplot(lobster_size_edits, aes(x=SIZE)) +
  geom_histogram() +
  facet_wrap(~SITE)

lobster_size_hist

lobster_size_qq <- ggplot(lobster_size_edits, aes(sample=SIZE)) +
  geom_qq() +
  facet_wrap(~SITE)

lobster_size_qq

lobster_traps_hist <- ggplot(lobster_traps_edits, aes(x=TRAPS)) +
  geom_histogram() +
  facet_wrap(~SITE)

lobster_traps_hist

lobster_traps_qq <- ggplot(lobster_traps_edits, aes(sample=TRAPS)) +
  geom_qq() +
  facet_wrap(~SITE)

lobster_traps_qq
```

```{r}
#4 create graphs of abundance and fishing pressure from 2012-2017

abundance_col <- ggplot(lobster_size_edits, aes(x=YEAR, y=COUNT)) +
  geom_col() +
  facet_wrap(~SITE)

abundance_col

fishing_pressure_col <- ggplot(lobster_traps_edits, aes(x=YEAR, y=TRAPS)) +
  geom_col() +
  facet_wrap(~SITE)

fishing_pressure_col
```

```{r}
#5 put lobster size data into case format.

lobster_case_format <- lobster_size_edits %>%
  filter(YEAR=="2017") %>%
  as.data.frame() %>%
  expand.dft(freq="COUNT")
```

```{r}
#6 run significance tests for lobster size
lobster_levene <- leveneTest(SIZE~SITE, data=lobster_case_format)
lobster_levene
#Variences are not equal check to see if another need to do another test beside anova

lobster_aov <- aov(SIZE~SITE, data=lobster_case_format)
summary(lobster_aov)

lobster_tukeys <- TukeyHSD(lobster_aov)
lobster_tukeys
```

